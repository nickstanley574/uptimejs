---
layout: base
header: Uptime and downtime with <span class="sla_percentage"></span> % SLA
permalink: /uptimejs
---

<p style="font-size:x-large;clear:both;">
    Agreed SLA level:
    <input style="font-size:x-large" type="text" id="input_sla_percentage" value="" size="5" maxlength="10"> %
    <button style="font-size:large" id="submitButton" onclick="generateDowntimeNumbers()">Calculate</button>
    <span style="font-size: 75%;">(or hit the <kbd>&lt;enter&gt;</kbd> key)</span>
</p>

<p>
    SLA level of <span class="sla_percentage"></span> % uptime/availability results in the following periods of allowed downtime/unavailability: 
</p>

<ul>
    <li><b>Daily:</b> <span id="dailyTime"></span></li>
    <li><b>Weekly:</b> <span id="weeklyTime"></span></li>
    <li><b>Monthly:</b> <span id="monthlyTime"></span></li>
    <li><b>Quarterly:</b> <span id="quarterlyTime"></span></li>
    <li><b>Yearly:</b> <span id="yearlyTime"></span></li>
</ul>

<p>
    Direct link to the page with these results: <a id="sla_link" href=""><span id="current_host"></span></a> 
</p>

<p>
    For convenience, there are special CEO and SEO friendly links for N nines:
    <a href="?sla=99.9">three nines</a>, <a href="?sla=99.99">four nines</a>, <a href="?sla=99.999">five nines</a>, <a href="?sla=99.9999">six nines</a>, and <a href="?sla=99.99999">seven nines</a>.
</p>


<script>

function getSecondsDownPerYear(uptimePercentage) {
  const uptime = uptimePercentage / 100;
  const secondsPerYear = 365 * 24 * 60 * 60;
  const secondsDownPerYear = secondsPerYear * (1 - uptime);
  return secondsDownPerYear;
}


function convertSecsToDays(seconds) {
	let days = (seconds > 1) ? parseInt(seconds / 86400) : 0;
	return days;
}

function convertSecsToHours(seconds) {
	let hours = parseInt(seconds / 3600);
	return hours;
}

function convertSecsToMinutes(seconds) {
	let minutes = parseInt(seconds / 60);
	return minutes;
}

function formattedElapsedTime(seconds){
    elapsedStr = ''

    let numOfDays = convertSecsToDays(seconds);

    elapsedStr += (numOfDays > 0) ? `${numOfDays}d ` : '';

    seconds = seconds % 86400; // Remaining second after getting the days

    let numOfHours = convertSecsToHours(seconds);

    elapsedStr += (numOfHours > 0) ? `${numOfHours}h ` : '';

    seconds = seconds % 3600; // Remaining second after getting the hours
    let numOfMinutes = convertSecsToMinutes(seconds);

    elapsedStr += (numOfMinutes > 0) ? `${numOfMinutes}m ` : '';

    let numOfSeconds = seconds % 60; // Remaining second after getting the minutes and also the result for the number of seconds

    if (numOfSeconds > 1) {
        numOfSeconds = numOfSeconds.toFixed(1)
    } else if (numOfSeconds < 0.01) {
        numOfSeconds = numOfSeconds.toFixed(4)
    } else {
        numOfSeconds = numOfSeconds.toFixed(2) 
    }

    elapsedStr += (numOfSeconds > 0) ? `${numOfSeconds}s ` : '';

    return elapsedStr
}

function generateDowntimeNumbers() {
    var sla_percentage = document.getElementById('input_sla_percentage').value;

    let secondsDownPerYear = getSecondsDownPerYear(sla_percentage)

    secondsDownPerDay = secondsDownPerYear / 365.2425
    secondsDownPerWeek = secondsDownPerYear / 52
    secondsDownPerMonth = secondsDownPerYear / 12
    secondsDownPerQuarter = secondsDownPerYear / 4

    document.getElementById('dailyTime').innerHTML = formattedElapsedTime(secondsDownPerDay);
    document.getElementById('weeklyTime').innerHTML = formattedElapsedTime(secondsDownPerWeek);
    document.getElementById('monthlyTime').innerHTML = formattedElapsedTime(secondsDownPerMonth);
    document.getElementById('quarterlyTime').innerHTML = formattedElapsedTime(secondsDownPerQuarter);
    document.getElementById('yearlyTime').innerHTML = formattedElapsedTime(secondsDownPerYear);
    
    var sla_percentage_locations = document.getElementsByClassName("sla_percentage");
    for (var i = 0; i < sla_percentage_locations.length; i++) {
        sla_percentage_locations[i].innerHTML = sla_percentage;
    }

    var yourElement = document.getElementById('sla_link');
    yourElement.setAttribute('href', `?sla=${sla_percentage}`);
}

const inputField = document.getElementById("input_sla_percentage");
const button = document.getElementById("submitButton");

const urlParams = new URLSearchParams(window.location.search);
const sla = urlParams.get('sla')


document.getElementById("current_host").textContent = window.location.href.replace(/(^\w+:|^)\/\//, '');

if (sla != null) {
    document.getElementById("input_sla_percentage").value = sla
    button.click()
} else {
    document.getElementById("input_sla_percentage").value = 99.99
    button.click()
}

inputField.addEventListener("keyup", function(event) {
    // Check if "Enter" key was pressed
    if (event.keyCode === 13) {
      button.click();
    }
  });

</script>
